<!DOCTYPE html>
<html lang="en">
<head>
    #parse("tags.vm")
</head>
<body>
<div class="container">
		<div class="page-header">
          <h1>项目报价</h1>
        </div>
    <form class="form-horizontal" role="form" id="createForm"   method="post"  >
        <div class="form-group">
            <label class="col-sm-2 control-label">项目名称： </label>
            <div class="col-sm-3">
                <input type="text" name="name" value="$!{projectVo.name}" disabled="disabled" class="form-control">
            </div>
            <label class="col-sm-2 control-label"> 招标单位：</label>
            <div class="col-sm-3">
                <input type="text" name="tenderee" value="$!{projectVo.tenderee}" disabled="disabled" class="form-control">
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label"> 设计单位： </label>
            <div class="col-sm-3">
                  <input type="text" name="designer"  value="$!{projectVo.designer}" disabled="disabled" class="form-control">
            </div>
            <label class="col-sm-2 control-label"> 代理单位： </label>
            <div class="col-sm-3">
                  <input type="text" name="agent" value="$!{projectVo.agent}" disabled="disabled" class="form-control">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"> 项目所在地： </label>
            <div class="col-sm-7">
                <input type="text" name="address" value="$!{projectVo.address}" disabled="disabled" class="form-control">
            </div>
        </div>
		
		<div class="form-group">
            <label class="col-sm-2 control-label"> 产品类型：</label>
            <div class="col-sm-8">
                <div class="checkbox">
                    #foreach($productType in $productTypeList)
                        <label style="width: 120px;"><input name="type" disabled="disabled" class="designerBudget"
                                      id="budget_$!{productType.id}" type="checkbox"
                                      value="$!{productType.id}"   />$!{productType.name}&nbsp;&nbsp;
                        </label>
                    #end
                </div>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"> 招标日期： </label>
            <div class="col-sm-3">
				 <input type="text"   name="tenderTime" disabled="disabled" 
                       value='$!{projectVo.tenderTime}'
                       onClick="WdatePicker({dateFmt:'yyyy-MM-dd'});" class="form-control"  >
            </div>
			<label class="col-sm-2 control-label">报备： </label>
            <div class="col-sm-3">
                  <input type="text" name="report" value="$!{projectVo.report}" disabled="disabled" class="form-control">
            </div>
        </div>
    </form>
	<br />
	<div class="page-header"/>
	<form class="form-horizontal" role="form" id="offerPriceForm"   method="post"  >
		<div class="form-group">
            <label class="col-sm-1 control-label">客户： </label>
            <div class="col-sm-2">
                <select class="input-medium" id="companyId" name="companyId" >
					#foreach($customer in $customerList)
                        <option value="$!{customer.id}">$!{customer.name}</option>
                    #end
				</select>
            </div>
            <label class="col-sm-2 control-label"> 报价人：</label>
            <div class="col-sm-2">
                <input type="text" name="tenderee" value="$!{projectVo.tenderee}"  class="input">
            </div>
			<label class="col-sm-2  control-label"> 联系方式：</label>
            <div class="col-sm-2">
                <input type="text" name="tenderee" value="$!{projectVo.tenderee}"  class="input">
            </div>
        </div>
		<div id="price">
		</div>
		<div class="form-group">
             <div class="col-sm-offset-4 col-sm-10">
				<input id="addButton" type="button" class="btn btn-primary"
                   value="新增报价"/>
				   <input id="saveButton" type="button" class="btn btn-primary"
                   onclick="saveOfferPrice();"
                   value="保存报价"/>
            </div>
        </div>
	</form>
</div>

<script type="text/javascript">

	$(function(){
	 var html= "<div class='form-group' ><label class='col-sm-1 control-label'>价格： </label><div class='col-sm-2'><input type='text' name='tenderee'   placeholder='（四位小数）元'  class='input'></div><label class='col-sm-2 control-label'> 系数：</label><div class='col-sm-2'><input type='text' name='tenderee'  placeholder='（0·10）'  class='input'></div><div class='col-sm-2'><input id='deleteButton' type='button' class='input' onclick='deleteOfferPrice(this)' value='删除'/></div></div>";
	 var init = 1;
    //添加div
    	$("#addButton").click(function () {
        $("#price").append(html);
    });
    //移除div
	$("#price").on('click', 'button[class="input"]', function () {
	alert("in");
        $(this).parents('.form-group').remove();
    });
    })

    function offerPrice(){
		$("#price").append(replaceAll(html,"_x",init));
		init=init+1;
    }
	function deleteOfferPrice(doms){
 		$(doms).parents('.form-group').remove();
   	 	//$("#id").remove();
		//init=init-1;
    }
 
	function saveOfferPrice(){
		//确认提交
		 confirmShows("确认保存？", function () {
		  	 $("#offerPriceForm").ajaxSubmit(function(data) { 
                // 提交成功后处理，message为提交页面的返回内容 
				 alertShow(data.msg, function () {
				 	reloadTable('/project/priceOffer');
                });
            });
		   });
	}
	
	function queryCustomer(){
		 $.ajax({
            type: "get",
            url: '/customer/query',
            dataType: 'json',
            success: function (data) {
                //提示审核通过成功信息并刷新页面
                 $("select[name='companyId']").empty();  
                //循环添加  
                 for(var j=0;j<data.length;j++){  
                    var option = $("<option>").val(data[j].id).text(data[j].name);  
                    $("select[name='companyId']").append(option);  
                }  
            },
            error: function (data) {
                if(data.msg){
                    alertShow(data.msg);
                }
                if(data.readyState == 4){
                    alertShow("Request Not Found");
                }
            }
        });

}
	
</script>

</body>
</html>